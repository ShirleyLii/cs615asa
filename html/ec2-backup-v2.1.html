<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>ec2-backup -- backup a directory into Elastic Block Storage (EBS)</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>

<p>
<b>ec2-backup</b> -- backup a directory into Elastic Block Storage (EBS)

<p>
<h2><a name='sect1' href='#toc1'><b>Synopsis</b></a></h2>

<p>
<b>ec2-backup</b> [<b>-hv</b>] [<b>-e</b> <i>recipient</i>] [<b>-i</b> <i>instance</i>] [<b>-t</b> <i>tag</i>] <b>-d</b> <i>dir</i>

<p>
<h2><a name='sect2' href='#toc2'><b>Description</b></a></h2>

<p>
The <b>ec2-backup</b> tool performs a backup of the given directory into Amazon
Elastic Block Storage (EBS). This is achieved by creating a volume of
the appropriate size, attaching it to an EC2 instance and finally copying
the files from the given directory into this volume.

<p>
<h2><a name='sect3' href='#toc3'><b>Options</b></a></h2>

<p>
<b>ec2-backup</b> accepts the following command-line flags:

<p>
<dl>

<dt><b>-h</b> </dt></dt>
<dd>           Print a usage statement and exit.

<p></dd>

<dt><b>-e</b> <i>recipient</i> </dt></dt>
<dd>Encrypt the data for the specified recipient.

<p></dd>

<dt><b>-i</b> <i>instance</i> </dt></dt>
<dd>Attach the volume in question to the given instance.

<p></dd>

<dt><b>-m</b> <i>method</i> </dt></dt>
<dd>    Use the given method to perform the backup. Valid methods
are &lsquo;dd&rsquo; and &lsquo;rsync&rsquo;; default is &lsquo;dd&rsquo;.

<p></dd>

<dt><b>-t</b> <i>tag</i> </dt></dt>
<dd>       Use the volume with the given tag. If no tag is specified,
use &lsquo;ec2-backup&rsquo;. If no such volume exists, create a new
one and apply the given tag.

<p></dd>

<dt><b>-v</b> </dt></dt>
<dd>           Be verbose. If not specified, <b>ec2-backup</b> will not generate
any output at all (unless an error is encountered).

<p></dd>
</dl>

<h2><a name='sect4' href='#toc4'><b>Details</b></a></h2>

<p>
<b>ec2-backup</b> will perform a backup of the given directory to an ESB volume.
The backup is done in one of two ways: via direct write to the volume
(utilizing <em>tar(1)</em>
 on the local host and <em>dd(1)</em>
 on the remote instance), or
via a (possibly incremental) filesystem sync (utilizing <em>rsync(1)</em>
).

<p><p>
<b>ec2-backup</b> will create a new volume (unless the <b>-t</b> flag was specified and
a volume matching the given tag already exists). The new volume will be
at least two times the size of the directory to be backed up.

<p><p>
Unless an instance is given using the <b>-i</b> flag, <b>ec2-backup</b> will create an
instance suitable to perform the backup, attach the volume in question
and then back up the data from the given directory using the specified
method and then shut down the instance it created.

<p>
<h2><a name='sect5' href='#toc5'><b>Encryption</b></a></h2>

<p>
If <b>-e</b> <i>recipient</i> was specified, then <b>ec2-backup</b> will encrypt the data for
the specified recipient. This implies a backup method of &lsquo;dd&rsquo; -- specifying
&lsquo;rsync&rsquo; with <b>-e</b> is thus an error condition.

<p><p>
<b>ec2-backup</b> will let the <em>gpg(1)</em>
 tool perform the encryption, and hence
recipients are specified in any manner that <em>gpg(1)</em>
 allows. Multiple
recipients are allowed.

<p>
<h2><a name='sect6' href='#toc6'><b>Output</b></a></h2>

<p>
Unless the <b>-v</b> flag is given, <b>ec2-backup</b> will not generate any output
unless any errors are encountered. Otherwise, it may print out some useful
information about what steps it is currently performing.

<p><p>
Any errors encountered cause a meaningful error message to be printed to
STDERR.

<p>
<h2><a name='sect7' href='#toc7'><b>Exit</b> <b>Status</b></a></h2>

<p>
The <b>ec2-backup</b> will exit with a return status of 0 under normal circumstances.
If an error occurred, <b>ec2-backup</b> will exit with a value &gt;0.

<p>
<h2><a name='sect8' href='#toc8'><b>Examples</b></a></h2>

<p>
The following examples illustrate common usage of this tool.

<p><p>
To back up the entire filesystem to a volume tagged as &lsquo;backup&rsquo; using
<em>rsync(1)</em>
:

<p><p><tt><pre>
ec2-backup -t backup -m rsync -d /
</pre></tt>
<p><p>
To create a complete backup of the current working directory using
defaults and encrypting for multiple recipients:

<p><p><tt><pre>
ec2-backup -e 6F6BD3D7 -e jschauma@cs.stevens.edu -d .
</tt></pre>
<p>
<h2><a name='sect9' href='#toc9'><b>See</b> <b>Also</b></a></h2>

<p>
<em>dd(1)</em>
, <a href='ec2-start-instance.1.html'>ec2-start-instance(1)</a>
, <em>gpg(1)</em>
, <em>tar(1)</em>
, <em>rsync(1)</em>


<p>
<h2><a name='sect10' href='#toc10'><b>History</b></a></h2>

<p>
<b>ec2-backup</b> was originally assigned by Jan Schaumann
&lt;jschauma@cs.stevens.edu&gt; as a homework assignment for the class &ldquo;Aspects
of System Administration&rdquo; at Stevens Institute of Technology in the
Spring of 2011.
<p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Options</a></li>
<li><a name='toc4' href='#sect4'>Details</a></li>
<li><a name='toc5' href='#sect5'>Encryption</a></li>
<li><a name='toc6' href='#sect6'>Output</a></li>
<li><a name='toc7' href='#sect7'>Exit Status</a></li>
<li><a name='toc8' href='#sect8'>Examples</a></li>
<li><a name='toc9' href='#sect9'>See Also</a></li>
<li><a name='toc10' href='#sect10'>History</a></li>
</ul>
</body>
</html>
